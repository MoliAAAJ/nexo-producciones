<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NEXO Producciones</title>

  <!-- IMPORTANTE: base para GitHub Pages -->
  <base href="/nexo-producciones/">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/891/891399.png" type="image/png">
</head>

<body class="bg-gray-900 text-white font-sans">

  <!-- HEADER -->
  <header class="text-center py-8 bg-gray-950 shadow-md">
    <img
      src="imagenes/nexo_logo_transparente.png"
      alt="NEXO Producciones"
      class="mx-auto mb-4 w-24 h-auto"
    />
    <h1 class="text-4xl font-bold tracking-widest text-purple-400">NEXO Producciones</h1>
    <p class="text-gray-400 mt-2">Eventos artÃ­sticos y culturales</p>
    <div class="flex justify-center gap-6 mt-4">
      <a
        href="https://www.facebook.com/nexo.producciones.2025"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="Facebook"
        class="text-gray-400 hover:text-blue-500 transition"
        >
        <!-- Facebook -->
        <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="currentColor">
          <path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8v-6.93H7.9V12H10V9.8c0-2.08 1.23-3.23 3.12-3.23.9 0 1.84.16 1.84.16v2.03h-1.04c-1.03 0-1.35.64-1.35 1.3V12h2.3l-.37 2.87h-1.93v6.93c4.56-.93 8-4.96 8-9.8z"/>
        </svg>
      </a>

      <a
        href="https://www.instagram.com/nexo_producciones_artisticas/"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="Instagram"
        class="text-gray-400 hover:text-pink-500 transition"
        >
        <!-- Instagram -->
        <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2.16c3.2 0 3.58.01 4.85.07 1.17.05 1.97.24 2.43.4a4.9 4.9 0 0 1 1.77 1.02 4.9 4.9 0 0 1 1.02 1.77c.16.46.35 1.26.4 2.43.06 1.27.07 1.65.07 4.85s-.01 3.58-.07 4.85c-.05 1.17-.24 1.97-.4 2.43a4.9 4.9 0 0 1-1.02 1.77 4.9 4.9 0 0 1-1.77 1.02c-.46.16-1.26.35-2.43.4-1.27.06-1.65.07-4.85.07s-3.58-.01-4.85-.07c-1.17-.05-1.97-.24-2.43-.4a4.9 4.9 0 0 1-1.77-1.02 4.9 4.9 0 0 1-1.02-1.77c-.16-.46-.35-1.26-.4-2.43C2.17 15.58 2.16 15.2 2.16 12s.01-3.58.07-4.85c.05-1.17.24-1.97.4-2.43a4.9 4.9 0 0 1 1.02-1.77 4.9 4.9 0 0 1 1.77-1.02c.46-.16 1.26-.35 2.43-.4C8.42 2.17 8.8 2.16 12 2.16zm0 3.68a6.16 6.16 0 1 0 0 12.32 6.16 6.16 0 0 0 0-12.32zm0 10.16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm6.4-10.88a1.44 1.44 0 1 1-2.88 0 1.44 1.44 0 0 1 2.88 0z"/>
        </svg>
      </a>
    </div>

  </header>

  <!-- CONTENEDOR DE EVENTOS -->
  <main class="container mx-auto p-6">
    <h2 class="text-2xl font-semibold mb-6 text-purple-300 border-b border-purple-500 pb-2">
      PrÃ³ximos eventos
    </h2>
    <div id="eventos" class="grid gap-6 md:grid-cols-2 lg:grid-cols-3"></div>
    <div class="mt-10 text-center text-sm text-gray-400 max-w-2xl mx-auto leading-relaxed">
      <p>
        Las entradas quedan reservadas una vez acreditado el pago.
        <br />
        Presentar comprobante al ingresar al evento.
      </p>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="text-center py-6 text-sm text-gray-500 border-t border-gray-800">
    Â© 2026 NEXO Producciones â€” Todos los derechos reservados
  </footer>

  <!-- MODAL COMPRA -->
  <div id="modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50">
    <div class="bg-gray-800 rounded-xl w-80 p-6 relative">
      <button id="cerrarModal" class="absolute top-2 right-2 text-gray-400 hover:text-white text-2xl">&times;</button>
      <h3 class="text-xl font-semibold text-purple-300 mb-4">Comprar entradas</h3>

      <label class="block mb-2 text-gray-400">Cantidad de entradas:</label>
      <input id="cantidadEntradas" type="number" min="1" value="1"
             class="w-full mb-4 p-2 rounded-lg bg-gray-700 text-white">

      <p class="text-gray-300 mb-4">Total: $<span id="montoTotal">0</span></p>

      <p class="text-gray-300 mb-2">Alias Mercado Pago:</p>
      <p class="text-white font-semibold mb-4">pepemoli.mp</p>

      <button id="confirmarCompra"
              class="w-full py-2 rounded-lg bg-purple-600 hover:bg-purple-700 text-white font-medium">
        Confirmar
      </button>
    </div>
  </div>

  <script>
    const SHEET_URL =
      "https://opensheet.elk.sh/18eeA9-n97tamAFPmO9Do0WOiU9v9SI7QPms0P144Jic/Hoja%201";

    const modal = document.getElementById("modal");
    const cerrarModal = document.getElementById("cerrarModal");
    const cantidadEntradas = document.getElementById("cantidadEntradas");
    const montoTotalElem = document.getElementById("montoTotal");
    const confirmarCompra = document.getElementById("confirmarCompra");

    let valorActual = 0;

    function abrirModal(valor) {
      valorActual = parseFloat(valor) || 100;
      cantidadEntradas.value = 1;
      montoTotalElem.textContent = valorActual.toFixed(2);
      modal.classList.remove("hidden");
    }

    cerrarModal.onclick = () => modal.classList.add("hidden");
    modal.onclick = (e) => { if (e.target === modal) modal.classList.add("hidden"); };

    cantidadEntradas.oninput = () => {
      const cantidad = parseInt(cantidadEntradas.value) || 1;
      montoTotalElem.textContent = (cantidad * valorActual).toFixed(2);
    };

    confirmarCompra.onclick = () => {
      alert(`Total a pagar: $${montoTotalElem.textContent}\nAlias: pepemoli.mp`);
      modal.classList.add("hidden");
    };

    function formatearFecha(fechaStr) {
      if (!fechaStr) return "";
      if (fechaStr.includes("/")) {
        const [d, m, y] = fechaStr.split("/");
        fechaStr = `${y}-${m}-${d}`;
      }
      const fecha = new Date(fechaStr);
      if (isNaN(fecha)) return fechaStr;
      return fecha.toLocaleDateString("es-AR", {
        day: "2-digit",
        month: "long",
        year: "numeric"
      });
    }

    async function cargarEventos() {
      const contenedor = document.getElementById("eventos");
      contenedor.innerHTML = "<p class='text-gray-400 animate-pulse'>Cargando eventos...</p>";

      try {
        const response = await fetch(SHEET_URL);
        const eventos = await response.json();
        contenedor.innerHTML = "";

        eventos.forEach(ev => {
          const nombre = ev.nombre?.trim() || "Evento sin nombre";
          const fecha = ev.fecha || "";
          const lugar = ev.lugar || "";
          const imagen = ev.imagen?.trim() || "";
          const estado = ev.estado?.toLowerCase() || "agotado";
          const valor = ev.valor ? parseFloat(ev.valor) : 100;

          const agotado = estado !== "disponible";

          const tarjeta = document.createElement("div");
          tarjeta.className =
            "bg-gray-800 rounded-2xl overflow-hidden shadow-lg hover:scale-[1.02] transition-transform";

          const imgWrapper = document.createElement("div");
          imgWrapper.className = "relative";

          const img = document.createElement("img");
          img.src = imagen || "imagenes/nexo_back.jpg";
          img.alt = nombre;
          img.className = "w-full h-48 object-cover bg-gray-700";
          img.loading = "lazy";

          img.onerror = () => {
            img.onerror = null;
            img.src = "imagenes/nexo_back.jpg";
          };

          imgWrapper.appendChild(img);

          if (agotado) {
            const badge = document.createElement("div");
            badge.className =
              "absolute top-2 left-2 bg-red-600 text-white font-bold px-3 py-1 rounded-lg text-sm";
            badge.textContent = "AGOTADO";
            imgWrapper.appendChild(badge);
          }

          const contenido = document.createElement("div");
          contenido.className = "p-5";

          const h3 = document.createElement("h3");
          h3.className = "text-xl font-semibold text-purple-300";
          h3.textContent = nombre;

          const pInfo = document.createElement("p");
          pInfo.className = "text-gray-400 text-sm mt-1";
          pInfo.textContent = `${formatearFecha(fecha)} â€” ${lugar}`;

          const pPrecio = document.createElement("p");
          pPrecio.className = "text-yellow-400 font-semibold text-lg mt-2";
          pPrecio.textContent = `ðŸ’° $${valor.toLocaleString("es-AR")}`;

          const boton = document.createElement("button");
          boton.className =
            `mt-4 w-full py-2 rounded-lg font-medium text-white ${
              agotado ? "bg-gray-700 cursor-not-allowed" : "bg-purple-600 hover:bg-purple-700"
            }`;
          boton.textContent = agotado ? "Agotado" : "Comprar entrada";

          if (!agotado) boton.onclick = () => abrirModal(valor);

          contenido.append(h3, pInfo, pPrecio, boton);
          tarjeta.append(imgWrapper, contenido);
          contenedor.appendChild(tarjeta);
        });

      } catch (error) {
        contenedor.innerHTML =
          "<p class='text-red-400'>Error al cargar los eventos.</p>";
        console.error(error);
      }
    }

    cargarEventos();
  </script>

</body>
</html>
